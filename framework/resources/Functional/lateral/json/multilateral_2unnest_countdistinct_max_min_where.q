select customer.c_custkey, customer.c_name, orders.orderkey, orders.totalprice, olineitems.l_items, olineitems.l_maxquantity, olineitems.l_minprice from customer, lateral (select t1.o.o_orderkey as orderkey, t1.o.o_totalprice as totalprice, t1.o.o_lineitems as lineitems from unnest(customer.c_orders) t1(o)) orders, lateral (select count(distinct(t2.l.l_partkey)) as l_items,  max(t2.l.l_quantity) as l_maxquantity, min(t2.l.l_extendedprice) as l_minprice from unnest(orders.lineitems) t2(l) where t2.l.l_quantity > 2 and t2.l.l_extendedprice < 5000) olineitems order by customer.c_custkey, orders.orderkey, orders.totalprice, olineitems.l_items, olineitems.l_maxquantity, olineitems.l_minprice limit 50;
