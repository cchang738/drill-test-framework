select customer.c_custkey, customer.c_name, orders.orderkey, orders.totalprice, olineitems.l_items, olineitems.l_costs from customer, lateral (select t1.o.o_orderkey as orderkey, t1.o.o_totalprice as totalprice, t1.o.o_lineitems as lineitems from unnest(customer.c_orders) t1(o)) orders, lateral (select count(t2.l.l_partkey) as l_items,  sum(t2.l.l_quantity * t2.l.l_extendedprice) as l_costs from unnest(orders.lineitems) t2(l)) olineitems order by customer.c_custkey, orders.orderkey, orders.totalprice, olineitems.l_items, olineitems.l_costs limit 50;
